(function(a){a.fn.extend({colorpicker:function(c,e){function r(){l.mouseleave(function(){})}function t(){p.text(c.label);p.click(function(){m.click()})}function u(){m.click(function(){var h=a(this).position(),c=h.top,h=h.left+a(this).width()+5;a(b).css({top:c,left:h}).fadeIn("slow");a(b).find(".ibs-colorpicker-picker-span:first").trigger("mouseover");a(b).find(".ibs-colorpicker-picker-span.active").trigger("mouseover")})}function v(){b.append(w);b.append(n);for(var h in k)b.append('<span class="ibs-colorpicker-picker-span '+
(k[h].color==a(d).children(":selected").text()?" active":"")+'" rel="'+k[h].value+'" style="background-color: '+k[h].color+"; width: "+c.size+"px; height: "+c.size+'px;"><div class="cpind"></div></span>');m.css("background-color",a(d).children(":selected").text());n.text(a(d).children(":selected").attr("rel"));a(b).on("mouseover",".ibs-colorpicker-picker-span",{},function(){var b=a(this).attr("rel"),c=a(d).find('option[value="'+b+'"]').text(),c=c?c.replace(/Dark/,"Dark ").replace(/Light/,"Light"):
b;n.text(c)},function(){n.text(b.children(".ibs-colorpicker-picker-span.ibs-active").attr("rel"))});a(b).on("click",".ibs-colorpicker-picker-span",{},function(){n.text(a(this).attr("rel"));a(d).val(a(this).attr("rel"));a(d).change();b.children(".ibs-colorpicker-picker-span.active").removeClass("ibs-active");a(this).addClass("ibs-active");m.css("background-color",a(this).css("background-color"));b.fadeOut("slow")});a(b).on("click",".ibs-cp-exit",{},function(a){b.fadeOut("slow")});a(d).after(b)}var f=
{label:"",size:20,count:6,hide:!0};if("undefined"!==typeof c&&"string"===typeof c)switch(c){case "stroke":if("undefined"===typeof e)return{color:rgb2hex(a(this).find(".ibs-colorpicker-trigger").css("background-color")),opacity:parseFloat(a(this).find(".ibs-colorpicker-trigger").css("opacity")).toFixed(3),weight:parseInt(a(this).find(".ibs-colorpicker-trigger").height()-2)};a(this).find(".ibs-opacity-val").val(parseFloat(e.opacity).toFixed(1));a(this).find(".ibs-width-val").val(parseInt(e.weight));
var f=a(this).find(".ibs-colorpicker-select"),x=e.color.toLowerCase();a.each(f,function(c,b){b.value.toLowerCase()===x?a(b).attr("selected",!0):a(b).removeAttr("selected")});var g=a(this).find(".ibs-colorpicker-trigger-div").height(),f=parseInt(e.weight)+2,g=(g-f)/2;a(this).find(".ibs-colorpicker-trigger").css({opacity:e.opacity,"background-color":e.color,height:f+"px","margin-top":g+"px","margin-bottom":g+"px"});break;case "opacity":a(this).find(".ibs-colorpicker-trigger").css("opacity",e);break;
case "weight":g=a(this).find(".ibs-colorpicker-trigger-div").height(),f=parseInt(e)+2,g=(g-f)/2,a(this).find(".ibs-colorpicker-trigger").css("height",f+"px"),a(this).find(".ibs-colorpicker-trigger").css("margin-top",g+"px"),a(this).find(".ibs-colorpicker-trigger").css("margin-bottom",g+"px")}else{c=a.extend(f,c);var d,k={},l=a("<div>").addClass("ibs-colorpicker-wrap"),p=a("<div>").addClass("ibs-colorpicker-label"),q=a("<div>").addClass("ibs-colorpicker-trigger-div").css({"background-color":"#ffffff",
float:"left",height:"20px"}),m=a("<div>").addClass("ibs-colorpicker-trigger");q.append(m);var b=a("<div>").addClass("ibs-colorpicker-picker").width((c.size+4)*c.count),n=a("<div>").addClass("ibs-colorpicker-picker-info"),w=a("<div>").addClass("ibs-cp-exit").css("float","right").append(a("<img>").addClass("ibs-cp-cancel")),y=a('<div style="clear:both;"></div>');return this.each(function(){d=this;a(d).html('<option value="#8B008B">DarkMagenta</option><option value="#008000">Green</option><option value="#D3D3D3">LightGray</option><option value="#00008B">DarkBlue</option><option value="#FFF380">Gold</option><option value="#FFFF00">Yellow</option><option value="#A9A9A9">DarkGray</option><option value="#008B8B">DarkCyan</option><option value="#FF0000">Red</option><option value="#0000FF">Blue</option><option value="#FF00FF">Magenta</option><option value="#8B0000">DarkRed</option><option value="#006400">DarkGreen</option><option value="#00FFFF">Cyan</option><option value="#000000">Black</option>');
a(d).children("option").each(function(b,c){k[b]={};k[b].color=a(c).text();k[b].value=a(c).val()});r();""!=c.label&&t();u();v();l.append(p);l.append(q);l.append(b);l.append(y);a(d).after(l);c.hide&&a(d).css({position:"absolute",left:-1E4})})}}})})(jQuery);
