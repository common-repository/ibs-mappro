function ShortcodeDialog(a){this.run(a)}
(function(a){ShortcodeDialog.prototype.run=function(d){var b=a("<div>").addClass("ibs-shortcode-dialog").attr({title:"Insert IBS Mappro Shortcode"}).hide().append(a("<div>").addClass("ibs-dialog-header ibs-shortcode-div").append(a("<div>").addClass("ibs-section-header").html("Select from map library")).append(a("<div>").addClass("ibs-shortcode-browser-div").append(a("<div>").addClass("ibs-shortcode-browser JQueryFTD"))).append(a("<div>").addClass("ibs-section-header").html("Options")).append(a("<div>").append(a("<label>").text("mode")).append(a("<label>").text("post/page")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-radio").attr({name:"admin",type:"radio",
value:"off",title:"for inserting standard map into post or page"}).prop("checked",!0)).append(a("<label>").text("admin")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-radio").attr({name:"admin",type:"radio",value:"on",title:"insert admin map into a secure page"}))).append(a("<div>").append(a("<label>").text("with")).append(a("<label>").text("list")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-ckb").attr({name:"list",type:"checkbox",value:"on",title:"add poi, seg, and wps list to map"})).append(a("<label>").text("controls")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-ckb").attr({name:"controls",
type:"checkbox",value:"on",title:"add display controls for map"})).append(a("<label>").text("search")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-ckb").attr({name:"search",type:"checkbox",value:"on",title:"add search box to map"})).append(a("<label>").text("elevation")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-ckb").attr({name:"elevation",type:"checkbox",value:"on",title:"add elevation display panel"}))).append(a("<div>").append(a("<label>").text("controls")).append(a("<label>").text("daggable")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-ckb").attr({name:"drag",
type:"checkbox",value:"on",title:"map draggable"})).append(a("<label>").text("maps")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-ckb").attr({name:"maptype",type:"checkbox",value:"on",title:"map types dropdown list"})).append(a("<label>").text("scroll")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-ckb").attr({name:"scroll",type:"checkbox",value:"on",title:"scrollwheel zooms"})).append(a("<label>").text("st.view")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-ckb").attr({name:"streetview",
type:"checkbox",value:"on",title:"streetview control"})).append(a("<label>").text("zoom")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-ckb").attr({name:"zoom",type:"checkbox",value:"on",title:"zoom control"}))).append(a("<div>").append(a("<label>").text("mrkr-mgr")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-ckb").attr({name:"markerManager",type:"checkbox",value:"on",title:"activate the marker manager"}))).append(a("<div>").append(a("<label>").text("title")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-txt").attr({name:"title",
type:"text",value:""}))).append(a("<div>").append(a("<label>").text("tag")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-txt").attr({name:"tag",type:"text",value:""}))).append(a("<div>").append(a("<label>").text("width")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-num").attr({name:"width",type:"number",value:"550",min:"100"})).append(a("<label>").text("height")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-num").attr({name:"height",type:"number",
value:"550",min:"100"})).append(a("<label>").text("align")).append(a("<select>").attr({name:"align"}).addClass("shortcode-option").append(a("<option>").attr({value:"left"}).text("left").prop("selected",!0)).append(a("<option>").attr({value:"center"}).text("center")).append(a("<option>").attr({value:"right"}).text("right")))).append(a("<div>").addClass("ibs-section-header").text("Map url(s)")).append(a("<input>").addClass("ibs-shortcode-url ibs-shortcode-option").attr({name:"maps",type:"text",value:""}).css("width",
"100%")).append(a("<div>").addClass("ibs-section-header").text("Shortcode")).append(a("<textarea>").attr({cols:"100",rows:"5",name:"maps",wrap:"soft"}).addClass("ibs-shortcode-result")).append(a("<div>").hide().append(a('<div class="ibs-upload-button" >').html("Browse")).append(a('<input class="ibs-upload-target-directory" >').attr({type:"text",size:"75",value:"/"})).append(a('<ul class="ibs-upload-list" >').addClass(" ibs-file-list"))));b.find(".ibs-upload-button").fineUploader({listElement:b.find(".ibs-upload-list"),
request:{endpoint:d.url+"lib/server/endpoint.php",params:{multiples:!1,dir:d.libpath+"uploads/"}},debug:!1}).on("complete","",{},function(a,e,f,c){a=d.liburl+"uploads/"+f;b.find(".ibs-shortcode-url").val(a);b.find(".ibs-shortcode-url").trigger("change")});b.dialog({autoOpen:!0,modal:!0,width:"500",buttons:{Upload:function(){var a=b.find(".ibs-upload-button");a.find("input[qq-button-id]");a.find("input").trigger("click")},Finish:function(){wp&&(wp.media.editor.insert(b.find("textarea").val()),b.dialog("close"))},
Cancel:function(){b.dialog("close")}},close:function(){b.dialog("destroy")},open:function(){var g=d.libpath+"maps/";b.find(".ibs-shortcode-browser").fileTree({root:g,script:d.ajax+"?action=ibs_mappro_index&func=folders&type=map&nonce="+d.nonce,folderEvent:"click",expandSpeed:0,collapseSpeed:0,multiFolder:!1},function(e){var f=["%maps%"];b.find(".ibs-shortcode-browser").find("a.selected").each(function(){var b=a(this).attr("rel").replace(d.libpath+"maps/","");f.push(b)});1===f.length?b.find(".ibs-shortcode-url").val(""):
b.find(".ibs-shortcode-url").val(f.join(";"));b.find(".ibs-shortcode-url").trigger("change")},function(a){});b.on("change",".ibs-shortcode-option",{},function(){var e="[ibs-mappro ";"on"===b.find("input[name=admin]:checked").val()?(e+='admin="on" ',b.find(".ibs-shortcode-ckb").prop("checked",!1).prop("disabled",!0).prop("checked",!0)):b.find(".ibs-shortcode-ckb").prop("disabled",!1);b.find("select").each(function(b,c){""!==a(c).val()&&(e+=a(c).attr("name")+'="'+a(c).val()+'" ')});b.find('input[type="text"].ibs-shortcode-option').each(function(b,
c){""!==a(c).val()&&(e+=a(c).attr("name")+'="'+a(c).val()+'" ')});b.find('input[type="number"]').each(function(b,c){""!==a(c).val()&&(e+=a(c).attr("name")+'="'+a(c).val()+'" ')});b.find('input[type="checkbox"]').each(function(b,c){a(c).is(":checked")&&(e+=a(c).attr("name")+'="'+a(c).val()+'" ')});b.find(".ibs-shortcode-result").val(e+"]")})}})}})(jQuery);function TrackingDialog(a){this.run(a)}
(function(a){TrackingDialog.prototype.run=function(d){var b=a("<div>").addClass("ibs-shortcode-dialog").attr({title:"Insert IBS Mappro Tracking"}).hide().append(a("<div>").addClass("ibs-dialog-header ibs-shortcode-div").append(a("<div>").addClass("ibs-section-header").html("Current tracked names")).append(a("<div>").addClass("ibs-shortcode-select-div").append(a("<select>").addClass("ibs-shortcode-select").append(a('<option value=""></option>')))).append(a("<div>").addClass("ibs-section-header").html("Track")).append(a("<div>").append(a("<label>").text("id")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-text").attr({name:"id",type:"text",
value:"",title:"marker name"}))).append(a("<div>").append(a("<label>").text("where")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-text").attr({name:"where",type:"text",value:"",title:"where marker is"}))).append(a("<div>").append(a("<label>").text("msg")).append(a("<input>").addClass("ibs-shortcode-option ibs-shortcode-text").attr({name:"msg",type:"text",value:"",title:"message"}))).append(a("<div>").addClass("ibs-section-header").text("Shortcode")).append(a("<textarea>").attr({cols:"100",
rows:"5",name:"maps",wrap:"soft"}).addClass("ibs-shortcode-result")));b.dialog({autoOpen:!0,modal:!0,width:"500",buttons:{Finish:function(){wp&&(wp.media.editor.insert(b.find("textarea").val()),b.dialog("close"))},Cancel:function(){b.dialog("close")}},close:function(){b.dialog("destroy")},open:function(){a.getJSON(d.ajax,{action:"ibs_mappro_index",func:"tracking",nonce:d.nonce}).done(function(g,e){for(var f in g)b.find(".ibs-shortcode-select").append(a("<option>").attr({value:f,where:g[f].where,msg:g[f].msg}).text(f))});
b.on("change",".ibs-shortcode-select",{},function(){var a=b.find("select").val();b.find("[name=id]").val(b.find("select").val());b.find("[name=where]").val(b.find('[value="'+a+'"]').attr("where"));b.find("[name=msg]").val(b.find('[value="'+a+'"]').attr("msg"));b.find(".ibs-shortcode-option").trigger("change")});b.on("change",".ibs-shortcode-option",{},function(){var d="[ibs-track ";b.find('input[type="text"]').each(function(b,f){""!==a(f).val()&&(d+=a(f).attr("name")+'="'+a(f).val()+'" ')});b.find(".ibs-shortcode-result").val(d+
"]")})}})}})(jQuery);
